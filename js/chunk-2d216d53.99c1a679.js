(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216d53"],{c3c0:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-data-table",{staticClass:"elevation-4",attrs:{headers:t.headers,items:t.tabledata,options:t.options,expanded:t.expanded,"fixed-header":"","show-expand":"",height:t.height,"item-key":"_id","no-data-text":"暂无数据","server-items-length":t.total_rows,"footer-props":{"items-per-page-options":t.items_per_page_options,"show-first-last-page":!0}},on:{"update:options":function(e){t.options=e},"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[t._v("数据表")]),a("v-divider",{staticClass:"mx-4",attrs:{insert:"",vertical:""}}),a("v-spacer"),a("v-btn",{attrs:{disabled:!t.load_data,color:"primary"},on:{click:t.load_csv_data}},[t._v("加载数据")]),a("v-divider",{staticClass:"mx-4",attrs:{insert:"",vertical:""}}),a("v-btn",{attrs:{disabled:!t.check_can_upload,color:"primary"},on:{click:t.check_can_upload_fun}},[t._v("校验数据")]),a("v-divider",{staticClass:"mx-4",attrs:{insert:"",vertical:""}}),a("v-btn",{attrs:{disabled:!t.upload,color:"primary"},on:{click:t.upload2db}},[a("v-icon",[t._v("cloud_upload")])],1)],1)]},proxy:!0}])})},s=[],i=a("84b5"),c=a("ca39"),l={data:function(){return{height:400,expanded:[],singleExpand:!0,options:{},tabledata:[],total_rows:10,load_data:!1,check_can_upload:!1,upload:!1,batchsize:3e3}},computed:{items_per_page_options:Object(i["d"])("db/items_per_page_options"),collection_config:Object(i["d"])("db/collection_config"),headers:Object(i["b"])("db/headers"),filepath:Object(i["b"])("db/uploaded_file_path"),file_hash:Object(i["d"])("db/file_hash"),collection:Object(i["d"])("db/collection")},methods:{load_csv_data:function(){var t=this,e=this.file_hash;if(e){var a=this.filepath[e];a?this.collection?c["s"]({hash:e,collection:this.collection,path:a}).then((function(e){200==e.code?(t.check_can_upload=!0,t.update_csv_page_data()):t.$store.dispatch("msglog/push_msg",{message:e.msg+e.error,type:"error"})})):console.log("未选择数据库"):console.log("文件未上传到服务器",e)}},update_csv_page_data:function(){var t=this;if(this.file_hash){var e=this.options.page,a=this.options.itemsPerPage;c["r"]({hash:this.file_hash,page:e,pagesize:a}).then((function(e){200==e.code?(console.log("更新分页成功",e),t.tabledata=e.data,t.total_rows=e.total):(console.log("更新分页失败",e),t.$store.dispatch("msglog/push_msg",{message:e.msg,type:"error"}))}))}},check_can_upload_fun:function(){var t=this;this.file_hash&&this.collection&&c["p"]({hash:this.file_hash,collection:this.collection}).then((function(e){200==e.code?t.upload=!0:(console.log("无法上传到数据库",e),t.$store.dispatch("msglog/push_msg",{message:e.msg+e.error,type:"error"}))}))},upload2db:function(){var t=this;this.file_hash&&this.collection&&c["t"]({hash:this.file_hash,collection:this.collection,batchsize:this.batchsize}).then((function(e){200==e.code?(t.$store.dispatch("msglog/push_msg",{message:e.msg,type:"success"}),t.upload=!1):(console.log("无法上传到数据库",e),t.$store.dispatch("msglog/push_msg",{message:e.msg+e.error,type:"error"}))}))}},watch:{options:{handler:function(){console.log("页面刷新",this.options),this.update_csv_page_data()},deep:!0},file_hash:function(){console.log("文件hash变化",this.file_hash),this.load_data=!0}}},n=l,d=a("9ca4"),h=a("aeb5"),r=a.n(h),p=a("acf8"),_=a("9e97"),u=a("ece4"),g=a("4e25"),f=a("983c"),b=a("85ca"),m=a("570a"),v=Object(d["a"])(n,o,s,!1,null,null,null);e["default"]=v.exports;r()(v,{VBtn:p["a"],VDataTable:_["a"],VDivider:u["a"],VIcon:g["a"],VSpacer:f["a"],VToolbar:b["a"],VToolbarTitle:m["a"]})}}]);
//# sourceMappingURL=chunk-2d216d53.99c1a679.js.map